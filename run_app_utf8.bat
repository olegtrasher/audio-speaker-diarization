@echo off
chcp 65001 > nul
echo.
echo üéµ AudioQA - –î–∏–∞—Ä–∏–∑–∞—Ü–∏—è –∞—É–¥–∏–æ
echo ================================
echo.

REM –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è Python
python --version >nul 2>&1
if %errorlevel% neq 0 (
    echo ‚ùå –û—à–∏–±–∫–∞: Python –Ω–µ –Ω–∞–π–¥–µ–Ω. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Python 3.8+
    pause
    exit /b 1
)

echo ‚úÖ Python –Ω–∞–π–¥–µ–Ω

REM –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è
if not exist "venv\Scripts\activate.bat" (
    echo üì¶ –°–æ–∑–¥–∞–Ω–∏–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è...
    python -m venv venv
    if %errorlevel% neq 0 (
        echo ‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è
        pause
        exit /b 1
    )
    echo ‚úÖ –í–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ —Å–æ–∑–¥–∞–Ω–æ
)

REM –ê–∫—Ç–∏–≤–∞—Ü–∏—è –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è
call venv\Scripts\activate.bat

REM –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
if not exist "venv\Lib\site-packages\streamlit" (
    echo üìö –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π...
    pip install -r requirements.txt
    if %errorlevel% neq 0 (
        echo ‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ —É—Å—Ç–∞–Ω–æ–≤–∫–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
        pause
        exit /b 1
    )
    echo ‚úÖ –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã
)

REM –ü–µ—Ä–µ—É—Å—Ç–∞–Ω–æ–≤–∫–∞ PyTorch —Å CUDA –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)
echo üöÄ –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏ –ø–µ—Ä–µ—É—Å—Ç–∞–Ω–æ–≤–∫–∞ PyTorch —Å CUDA...
pip install torch torchaudio --index-url https://download.pytorch.org/whl/cu118 --upgrade

REM –°–æ–∑–¥–∞–Ω–∏–µ .env —Ñ–∞–π–ª–∞ –∏–∑ –ø—Ä–∏–º–µ—Ä–∞ –µ—Å–ª–∏ –µ–≥–æ –Ω–µ—Ç
if not exist ".env" (
    if exist "env.example" (
        copy "env.example" ".env"
        echo üìù –°–æ–∑–¥–∞–Ω —Ñ–∞–π–ª .env –∏–∑ –ø—Ä–∏–º–µ—Ä–∞
        echo ‚ö†Ô∏è  –í–ù–ò–ú–ê–ù–ò–ï: –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ —Ñ–∞–π–ª .env –∏ —É–∫–∞–∂–∏—Ç–µ –≤–∞—à HUGGINGFACE_TOKEN
        echo üöÄ GPU –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –Ω–∞–ª–∏—á–∏–∏
        pause
    )
)

REM –¢–æ–∫–µ–Ω Hugging Face –ø—Ä–æ–ø–∏—Å–∞–Ω –≤ –∫–æ–¥–µ, –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–µ –Ω—É–∂–Ω–∞
echo ‚úÖ –¢–æ–∫–µ–Ω Hugging Face: –≤—Å—Ç—Ä–æ–µ–Ω –≤ –∫–æ–¥

echo.
echo üöÄ –ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è...
echo üåê –û—Ç–∫—Ä–æ–µ—Ç—Å—è –±—Ä–∞—É–∑–µ—Ä —Å –∞–¥—Ä–µ—Å–æ–º: http://localhost:8501
echo.
echo üõë –î–ª—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∏: –∑–∞–∫—Ä–æ–π—Ç–µ —ç—Ç–æ –æ–∫–Ω–æ –∏–ª–∏ –Ω–∞–∂–º–∏—Ç–µ Ctrl+C –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª–µ
echo üí° –ò–ª–∏ –ø—Ä–æ—Å—Ç–æ –∑–∞–∫—Ä–æ–π—Ç–µ –±—Ä–∞—É–∑–µ—Ä –∏ —ç—Ç–æ –æ–∫–Ω–æ –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏
echo.

REM –ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
streamlit run audio_diarization_app.py

echo.
echo –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–æ.
pause 